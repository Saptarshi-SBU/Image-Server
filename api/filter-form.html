<!DOCTYPE html>
<html>
<head>
<style>
img { 
    width: 50%; 
}
.marginauto {
    margin: 20px auto 20px;
    display: block;
}
label {
    font-size: 32px;
}
</style>
</head>

<div align="center" style="font-size: 32px;" >
    <br> Welcome to Image Search </br>
</div>    

<form id='file-catcher'>

  <div  align="center"> 
    <label for="From"> Year </label>
    <input id='from-year-input' name='from-year' type='text' style ="font-size: 32px;"> </input>
    <input id='to-year-input'   name='to-year'   type='text' style ="font-size: 32px;"> </input>
  </div>

  <br> </br>

  <div  align="center">
    <label for="Album">Album </label>
    <input id='album-input'  name='album' type='text' style ="font-size: 32px;" > </input>
  </div>

  <br> </br>

  <div  align="center">  <label for="Submit"> Submit</label>
    <button id='query-button' type='submit'  name="query"   style="height: 32px; width: 128px; font-size: 24px;">
    Submit
    </button>
    <input id="action" type="button" value="Reset" onclick="run_reset()" style ="font-size: 16px" ></input>
  </div>
</form>

<script type="text/javascript">
  function run_reset() {
    var uploadButton = document.getElementById('query-button');
    uploadButton.textContent = "Submit"
  }
</script>  

<p id="demo"></p>

<script>
(function () {
  var from_year = document.getElementById('from-year-input');
  var to_year = document.getElementById('to-year-input');
  var album = document.getElementById('album-input');
  var fileCatcher = document.getElementById('file-catcher');
  var uploadButton = document.getElementById('query-button');
  
  var sendFile;

  fileCatcher.addEventListener('submit', function (evnt) {
    evnt.preventDefault();
    sendFile();
  });
  
  sendFile = function () {
    var formData = new FormData();
    formData.set('from_year', from_year.value);
    formData.set('to_year',   to_year.value);
    formData.set('album',     album.value);

    var xmlhttp  = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function() {
        if (this.readyState == XMLHttpRequest.DONE && this.status == 200) {
            var txt = ""
            var img_urls = ""
            var arr = JSON.parse(xmlhttp.responseText)
            console.log('\nlog: ' + arr.length)
            for (var i in arr) {
                //img_urls += "<div align=center> <font size=+2>" + arr[i] + "</font> </div>"
                img_urls += "<div><img class=marginauto src=http://192.168.0.12:4040/api/v1/scaledphoto?img=" + arr[i] + " style=width:800px;height:600px; alt=centered image/></div>"
            }
            document.getElementById("demo").innerHTML = img_urls;
            uploadButton.textContent = "Done"
        }
    };
    xmlhttp.open("POST", 'http://192.168.0.12:4040/api/v1/search');
    xmlhttp.send(formData);
  };
})();
</script>
</html>
